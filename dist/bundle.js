(()=>{"use strict";({156:function(){var e=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,l){function s(e){try{c(i.next(e))}catch(e){l(e)}}function o(e){try{c(i.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((i=i.apply(e,t||[])).next())}))};class t{constructor(e){this.data=e}}let n=[];window.addEventListener("DOMContentLoaded",(()=>{let e=localStorage.getItem("defaultServer"),t=localStorage.getItem("Channel"),n=localStorage.getItem("URLs");e&&t&&n&&(new i(e,t,JSON.parse(n)).initialize(),new r(e,t).initialize())}));class i{constructor(e,t,n){this.serverUrl=e,this.channel=t,this.urlList=[],this.currentIndex=0,this.urlList=n}initialize(){this.drawer(),document.addEventListener("click",(()=>this.onClick()))}drawer(){return e(this,void 0,void 0,(function*(){if(this.currentIndex<this.urlList.length){const e=yield this.fetcher(this.urlList[this.currentIndex]);console.log(`Drawing content: ${e.data.filename}`)}}))}onClick(){return e(this,void 0,void 0,(function*(){if(this.currentIndex++,yield this.drawer(),this.currentIndex+1<this.urlList.length){const e=yield this.fetcher(this.urlList[this.currentIndex+1]);n.push(e)}}))}fetcher(n){return e(this,void 0,void 0,(function*(){const e=yield fetch(n),i=yield e.blob(),r=yield i.arrayBuffer();return new t({binary:r,filename:n.split("/").pop()||"unknown",mimetype:i.type})}))}}class r{constructor(e,t){this.serverUrl=e,this.channel=t,this.menu=null}initialize(){this.createMenu(),this.loadChannelList()}createMenu(){this.menu=document.createElement("div"),this.menu.id="hamburger-menu",this.menu.style.position="fixed",this.menu.style.top="10px",this.menu.style.right="10px",document.body.appendChild(this.menu);const e=document.createElement("button");e.textContent="â˜°",e.onclick=()=>this.toggleMenu(),this.menu.appendChild(e);const t=document.createElement("div");t.style.display="none",this.menu.appendChild(t),this.createServerUrlInput(t),this.createChannelSelect(t)}toggleMenu(){var e;const t=null===(e=this.menu)||void 0===e?void 0:e.querySelector("div");t&&(t.style.display="none"===t.style.display?"block":"none")}createServerUrlInput(e){const t=document.createElement("input");t.type="text",t.value=this.serverUrl,t.onchange=e=>{const t=e.target;localStorage.setItem("defaultServer",t.value),this.serverUrl=t.value},e.appendChild(t)}createChannelSelect(e){const t=document.createElement("select");t.onchange=e=>{const t=e.target;localStorage.setItem("Channel",t.value),this.channel=t.value},e.appendChild(t)}loadChannelList(){return e(this,void 0,void 0,(function*(){var e;try{const t=yield fetch(`${this.serverUrl}/channels`),n=yield t.json(),i=null===(e=this.menu)||void 0===e?void 0:e.querySelector("select");i&&(n.forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e,i.appendChild(t)})),i.value=this.channel)}catch(e){console.error("Failed to load channel list:",e)}}))}}}})[156]()})();